---
title: "fireNull"
author: "Steve Cumming"
date: "04 August 2016"
output: html_document
bibliography: citation.bib
---

# Overview

This module provide a basic representation of spatially variable fire regime for the LandWeb study region. It can be used as a null fire model in any LandWeb simulation. 

The spatially variable fire regime paramater is the
__Fire Return Interval__. We expect the parent LandWeb module to provide a shapefile in the sim environment that contains this element. The expected shapefile name is

**shapeFileFireRegime**

and the expected field name is

**fireReturnInterval**

This shapefile was derived by Cumming's lab from an image on a power point slide, prepared by Dr. David Andison. This image presented Andison and Company's estimates of pre-modern fire return intervals by ecoregion or ecodistrict, within what we take to be the LandWeb study region. An image of this map, and references to any supporting documents, will be addded to this .Rmd file in due course. 

The module code is based on Cumming's spatialised implementation of the model of @wagner1978age. This very widley used theoretical model relates forest age distributions to the "fire cycle"", defined as the length of time by which accumulated fires will burn an total area equal to the size of a given study area. Under very strong assumptions of stationarity and spatial homogeneity (assumptions which almost nobody now believes to hold anywhere), this is equivalent to the periodic probability of burning at a point. A fire cycle of length __f__ can be simulated in SpaDES by burning raster cells with periodic probability  __p = 1/f__. This model simulates a fire cycle of length __f__ by randomly burning pixels with a  probability __p__,  that may vary among spatial polygons but is uniform within spatial polygons. The units of time are years.

According to @reed2006note, the equation relating __p__ and __f__ only applies if the size of fires is constant. For any other size distribution, the expected length of simulated fire cycles is longer than __f__.  In this module, where each pixel burns independently, all fires have size one pixel, so Reed's condition applies. However, users should take note that, because of the dependency on the fire size distribution, the application of the original fire cycle concept "causes confusion in simulation studies" [@reed2006note].

# Usage

```{r module_usage,eval=FALSE}
library(SpaDES)
library(magrittr)

inputDir <- file.path(tempdir(), "inputs") %>% checkPath(create = TRUE)
outputDir <- file.path(tempdir(), "outputs")
times <- list(start = 0, end = 10)
parameters <- list(
  .globals = list(burnStats = "nPixelsBurned"),
  #.progress = list(type = "text", interval = 1), # for a progress bar
  ## If there are further modules, each can have its own set of parameters:
  #module1 = list(param1 = value1, param2 = value2),
  #module2 = list(param1 = value1, param2 = value2)
)
modules <- list("fireNull")
objects <- list()
paths <- list(
  cachePath = file.path(outputDir, "cache"),
  modulePath = file.path(".."),
  inputPath = inputDir,
  outputPath = outputDir
)

mySim <- simInit(times = times, params = parameters, modules = modules,
                 objects = objects, paths = paths)

spades(mySim)
```

# Events

## Init

This creates an optional cummulative burn record in the form of sim raster object __timeSinceFireMap__ that  conforms to the study area template raster, here assumed to be sim raster object __studyAreaRaster__. The tsfMap is initialised to 0.

## Burn

This event simply applies the burn probability map to randomly select pixels for burning, and returns a vector of the burned cells as sim vector object __ignitionLoci__

If the __timeSinceFireMap__ exists, it is updated.

## Plotting

No plots are generated

## Saving

No files or state are saved

## Stats

Some summary statistics are gathered, inherited from Cumming's vanWagner module. 

# Data dependencies

## Input data

__shapeFileFireRegime__ is defines the regions and species fire return interval

__studyAreaRaster__ is the template raster for the study region

__flammableMap__ if it exists, we assume its logical and confcorms with the templatem abd that 0s are unburny. 

## Output data

Description of the module outputs.

__burnLoci__ a numeric vector of locations of burned cells relative to the template raster

__currentBurnMap__ a logical map of the currently burned locations, just a very long-winded representation of __burnLoci__

# Links to other modules

Describe any anticipated linkages to other modules.


